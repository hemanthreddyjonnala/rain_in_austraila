if(!require(InformationValue)) install.packages("InformationValue")
> if(!require(caTools)) install.packages("caTools")
> if(!require(caret)) install.packages("caret")
> if(!require(naivebayes)) install.packages("naivebayes")
> if(!require(party)) install.packages("party")
> if(!require(rpart.plot)) install.packages("rpart.plot")
> if(!require(e1071)) install.packages("e1071")
> if(!require(MLMetrics)) install.packages("MLMetrics")
Loading required package: MLMetrics
Installing package into ‘/home/rstudio-user/R/x86_64-pc-linux-gnu-library/3.6’
(as ‘lib’ is unspecified)
Warning in install.packages :
  package ‘MLMetrics’ is not available (for R version 3.6.0)
Warning in install.packages :
  Perhaps you meant ‘MLmetrics’ ?
Warning message:
In library(package, lib.loc = lib.loc, character.only = TRUE, logical.return = TRUE,  :
  there is no package called ‘MLMetrics’
> if(!require(varhandle)) install.packages("varhandle")
> if(!require(purrr)) install.packages("purrr")
> if(!require(corrplot)) install.packages("corrplot")
> if(!require(ggplot2)) install.packages("ggplot2")
> if(!require(cowplot)) install.packages("cowplot")
> 
> 
> library(readr)
> library(dplyr)
> library(party)
> library(rpart)
> library(rpart.plot)
> library(ROCR)
> library(caret)
> 
> 
> setwd("/cloud/project")
> getwd()
[1] "/cloud/project"
> 
> # Import test data
> weather_data = "weatherAUS.csv"
> raw_data<- read.csv(weather_data)
> 
> head(raw_data)  # display the first 6 observations
        Date Location MinTemp MaxTemp Rainfall Evaporation Sunshine WindGustDir
1 2008-12-01   Albury    13.4    22.9      0.6          NA       NA           W
2 2008-12-02   Albury     7.4    25.1      0.0          NA       NA         WNW
3 2008-12-03   Albury    12.9    25.7      0.0          NA       NA         WSW
4 2008-12-04   Albury     9.2    28.0      0.0          NA       NA          NE
5 2008-12-05   Albury    17.5    32.3      1.0          NA       NA           W
6 2008-12-06   Albury    14.6    29.7      0.2          NA       NA         WNW
  WindGustSpeed WindDir9am WindDir3pm WindSpeed9am WindSpeed3pm Humidity9am
1            44          W        WNW           20           24          71
2            44        NNW        WSW            4           22          44
3            46          W        WSW           19           26          38
4            24         SE          E           11            9          45
5            41        ENE         NW            7           20          82
6            56          W          W           19           24          55
  Humidity3pm Pressure9am Pressure3pm Cloud9am Cloud3pm Temp9am Temp3pm RainToday
1          22      1007.7      1007.1        8       NA    16.9    21.8        No
2          25      1010.6      1007.8       NA       NA    17.2    24.3        No
3          30      1007.6      1008.7       NA        2    21.0    23.2        No
4          16      1017.6      1012.8       NA       NA    18.1    26.5        No
5          33      1010.8      1006.0        7        8    17.8    29.7        No
6          23      1009.2      1005.4       NA       NA    20.6    28.9        No
  RISK_MM RainTomorrow
1     0.0           No
2     0.0           No
3     0.0           No
4     1.0           No
5     0.2           No
6     0.0           No
> print(summary(raw_data))
         Date            Location         MinTemp         MaxTemp     
 2013-03-02:    49   Canberra:  3418   Min.   :-8.50   Min.   :-4.80  
 2013-03-03:    49   Sydney  :  3337   1st Qu.: 7.60   1st Qu.:17.90  
 2013-03-04:    49   Perth   :  3193   Median :12.00   Median :22.60  
 2013-03-06:    49   Darwin  :  3192   Mean   :12.19   Mean   :23.23  
 2013-03-07:    49   Hobart  :  3188   3rd Qu.:16.80   3rd Qu.:28.20  
 2013-03-10:    49   Brisbane:  3161   Max.   :33.90   Max.   :48.10  
 (Other)   :141899   (Other) :122704   NA's   :637     NA's   :322    
    Rainfall       Evaporation        Sunshine      WindGustDir    WindGustSpeed   
 Min.   :  0.00   Min.   :  0.00   Min.   : 0.00   W      : 9780   Min.   :  6.00  
 1st Qu.:  0.00   1st Qu.:  2.60   1st Qu.: 4.90   SE     : 9309   1st Qu.: 31.00  
 Median :  0.00   Median :  4.80   Median : 8.50   E      : 9071   Median : 39.00  
 Mean   :  2.35   Mean   :  5.47   Mean   : 7.62   N      : 9033   Mean   : 39.98  
 3rd Qu.:  0.80   3rd Qu.:  7.40   3rd Qu.:10.60   SSE    : 8993   3rd Qu.: 48.00  
 Max.   :371.00   Max.   :145.00   Max.   :14.50   (Other):86677   Max.   :135.00  
 NA's   :1406     NA's   :60843    NA's   :67816   NA's   : 9330   NA's   :9270    
   WindDir9am      WindDir3pm     WindSpeed9am   WindSpeed3pm    Humidity9am    
 N      :11393   SE     :10663   Min.   :  0    Min.   : 0.00   Min.   :  0.00  
 SE     : 9162   W      : 9911   1st Qu.:  7    1st Qu.:13.00   1st Qu.: 57.00  
 E      : 9024   S      : 9598   Median : 13    Median :19.00   Median : 70.00  
 SSE    : 8966   WSW    : 9329   Mean   : 14    Mean   :18.64   Mean   : 68.84  
 NW     : 8552   SW     : 9182   3rd Qu.: 19    3rd Qu.:24.00   3rd Qu.: 83.00  
 (Other):85083   (Other):89732   Max.   :130    Max.   :87.00   Max.   :100.00  
 NA's   :10013   NA's   : 3778   NA's   :1348   NA's   :2630    NA's   :1774    
  Humidity3pm      Pressure9am      Pressure3pm        Cloud9am        Cloud3pm    
 Min.   :  0.00   Min.   : 980.5   Min.   : 977.1   Min.   :0.00    Min.   :0.0    
 1st Qu.: 37.00   1st Qu.:1012.9   1st Qu.:1010.4   1st Qu.:1.00    1st Qu.:2.0    
 Median : 52.00   Median :1017.6   Median :1015.2   Median :5.00    Median :5.0    
 Mean   : 51.48   Mean   :1017.7   Mean   :1015.3   Mean   :4.44    Mean   :4.5    
 3rd Qu.: 66.00   3rd Qu.:1022.4   3rd Qu.:1020.0   3rd Qu.:7.00    3rd Qu.:7.0    
 Max.   :100.00   Max.   :1041.0   Max.   :1039.6   Max.   :9.00    Max.   :9.0    
 NA's   :3610     NA's   :14014    NA's   :13981    NA's   :53657   NA's   :57094  
    Temp9am         Temp3pm      RainToday        RISK_MM        RainTomorrow
 Min.   :-7.20   Min.   :-5.40   No  :109332   Min.   :  0.000   No :110316  
 1st Qu.:12.30   1st Qu.:16.60   Yes : 31455   1st Qu.:  0.000   Yes: 31877  
 Median :16.70   Median :21.10   NA's:  1406   Median :  0.000               
 Mean   :16.99   Mean   :21.69                 Mean   :  2.361               
 3rd Qu.:21.60   3rd Qu.:26.40                 3rd Qu.:  0.800               
 Max.   :40.20   Max.   :46.70                 Max.   :371.000               
 NA's   :904     NA's   :2726                                                
> 
> # converting categrical data numeric data
> objects <- c("Location", "WindGustDir", "WindDir9am", "WindDir3pm", "RainToday", "RainTomorrow")
> for (obj in objects){
+   print(rev(levels(raw_data[[obj]])))
+   raw_data[[obj]]<- unclass(factor(raw_data[[obj]], levels=rev(levels(raw_data[[obj]]))))
+ }
 [1] "Woomera"          "Wollongong"       "Witchcliffe"      "Williamtown"     
 [5] "Watsonia"         "Walpole"          "WaggaWagga"       "Uluru"           
 [9] "Tuggeranong"      "Townsville"       "SydneyAirport"    "Sydney"          
[13] "SalmonGums"       "Sale"             "Richmond"         "Portland"        
[17] "PerthAirport"     "Perth"            "Penrith"          "PearceRAAF"      
[21] "Nuriootpa"        "NorfolkIsland"    "NorahHead"        "Nhil"            
[25] "Newcastle"        "MountGinini"      "MountGambier"     "Moree"           
[29] "Mildura"          "MelbourneAirport" "Melbourne"        "Launceston"      
[33] "Katherine"        "Hobart"           "GoldCoast"        "Darwin"          
[37] "Dartmoor"         "CoffsHarbour"     "Cobar"            "Canberra"        
[41] "Cairns"           "Brisbane"         "Bendigo"          "Ballarat"        
[45] "BadgerysCreek"    "AliceSprings"     "Albury"           "Albany"          
[49] "Adelaide"        
 [1] "WSW" "WNW" "W"   "SW"  "SSW" "SSE" "SE"  "S"   "NW"  "NNW" "NNE" "NE"  "N"  
[14] "ESE" "ENE" "E"  
 [1] "WSW" "WNW" "W"   "SW"  "SSW" "SSE" "SE"  "S"   "NW"  "NNW" "NNE" "NE"  "N"  
[14] "ESE" "ENE" "E"  
 [1] "WSW" "WNW" "W"   "SW"  "SSW" "SSE" "SE"  "S"   "NW"  "NNW" "NNE" "NE"  "N"  
[14] "ESE" "ENE" "E"  
[1] "Yes" "No" 
[1] "Yes" "No" 
> 
> 
> # replacing NA values with zero
> data <- na.omit(raw_data)
> drops <- c("Date","RISK_MM")
> data <-data[ , !(names(data) %in% drops)]
> 
> # check for correlated factors
> numeric <- map_lgl(data, is.numeric)
> 
> correlations <- cor(data[,numeric])
> 
> diag(correlations) <- 0
> 
> high <- apply(abs(correlations) >= 0.6, 2, any)
> 
> corrplot(correlations[high, high], method = "number")
> 
> # feature extraction using PCA
> data_PCA <- prcomp(data,scale.=T)
> class(data_PCA)
[1] "prcomp"
> plot(data_PCA)
> summary(data_PCA)
Importance of components:
                          PC1    PC2    PC3     PC4     PC5     PC6     PC7    PC8
Standard deviation     2.4166 1.9844 1.5502 1.29857 1.08292 0.99766 0.98507 0.9107
Proportion of Variance 0.2655 0.1790 0.1092 0.07665 0.05331 0.04524 0.04411 0.0377
Cumulative Proportion  0.2655 0.4445 0.5537 0.63033 0.68363 0.72887 0.77298 0.8107
                           PC9    PC10    PC11    PC12    PC13    PC14    PC15
Standard deviation     0.82231 0.75714 0.68463 0.65294 0.62625 0.60592 0.60094
Proportion of Variance 0.03074 0.02606 0.02131 0.01938 0.01783 0.01669 0.01641
Cumulative Proportion  0.84142 0.86748 0.88878 0.90816 0.92599 0.94267 0.95909
                          PC16    PC17    PC18    PC19    PC20    PC21    PC22
Standard deviation     0.54735 0.49144 0.46352 0.28982 0.16838 0.14712 0.10041
Proportion of Variance 0.01362 0.01098 0.00977 0.00382 0.00129 0.00098 0.00046
Cumulative Proportion  0.97271 0.98369 0.99345 0.99727 0.99856 0.99954 1.00000
> head(data_PCA)
$sdev
 [1] 2.4166446 1.9843586 1.5501733 1.2985733 1.0829237 0.9976596 0.9850666 0.9107231
 [9] 0.8223133 0.7571420 0.6846253 0.6529449 0.6262478 0.6059181 0.6009402 0.5473488
[17] 0.4914420 0.4635212 0.2898235 0.1683839 0.1471168 0.1004114

$rotation
                      PC1         PC2         PC3          PC4          PC5
Location      -0.06289924 -0.03614484  0.14159118 -0.108879765 -0.115545757
MinTemp       -0.25693910 -0.27767821  0.21726623 -0.074261350  0.018775082
MaxTemp       -0.37711155 -0.08365019  0.14358788 -0.097450785  0.016126510
Rainfall       0.08608839 -0.22300343  0.07180013 -0.129498166 -0.604782419
Evaporation   -0.30524339 -0.07519603 -0.06765857 -0.007476699  0.097259421
Sunshine      -0.27092387  0.23383762 -0.15993109 -0.100701108 -0.233803079
WindGustDir   -0.11713699  0.05579412  0.32873059  0.471111680 -0.161314069
WindGustSpeed -0.05030229 -0.26964799 -0.40439958  0.276152481 -0.042880900
WindDir9am    -0.11933376  0.05967068  0.18252950  0.393943893  0.007324206
WindDir3pm    -0.09554516  0.04161369  0.32908412  0.448733158 -0.158329762
WindSpeed9am  -0.04791340 -0.17125001 -0.35235360  0.362794961 -0.094255791
WindSpeed3pm  -0.04237465 -0.21278757 -0.37125320  0.268427052 -0.077240729
Humidity9am    0.29313514 -0.09187665  0.20690279 -0.069953568 -0.098453856
Humidity3pm    0.25850689 -0.23020528  0.21199040  0.021631981  0.004141494
Pressure9am    0.13956937  0.37696093  0.09330057  0.144829943 -0.085965694
Pressure3pm    0.18127152  0.34557517  0.04545948  0.110594660 -0.085832452
Cloud9am       0.19079840 -0.26959668  0.15500389  0.057510870  0.276167664
Cloud3pm       0.18880202 -0.27185498  0.13496524  0.094607864  0.333477663
Temp9am       -0.33480494 -0.19347122  0.18188193 -0.080390696  0.018288420
Temp3pm       -0.37762379 -0.05824417  0.14809865 -0.097960904 -0.007861913
RainToday     -0.15302430  0.24309392 -0.02417450  0.128068832  0.525042227
RainTomorrow  -0.12191193  0.28167782 -0.07252610 -0.066688682 -0.017582624
                      PC6          PC7          PC8          PC9          PC10
Location      -0.70712455 -0.586321576  0.133213113 -0.008168009 -0.2150892709
MinTemp        0.25047151 -0.193285486 -0.121572496 -0.041643542 -0.1438393467
MaxTemp        0.12040750 -0.003441848  0.044889978 -0.033114148 -0.1169463609
Rainfall       0.09506315  0.078125957  0.321276392  0.089375525  0.1209309535
Evaporation    0.21977502 -0.040653734  0.269229107 -0.100114941  0.2663021814
Sunshine      -0.01722185  0.060118051 -0.211065446 -0.018261409 -0.0832337265
WindGustDir   -0.08249148 -0.004051708 -0.090658619  0.080934978  0.1703653798
WindGustSpeed -0.03992921 -0.010513531  0.006905301 -0.033850668 -0.0441103458
WindDir9am    -0.14740467  0.481302686  0.315549771  0.097184763 -0.5793339063
WindDir3pm    -0.04860801 -0.073598439 -0.239144300  0.031001586  0.4380337174
WindSpeed9am   0.07066287 -0.229538880  0.169812559 -0.033345110 -0.0003428002
WindSpeed3pm   0.10578697 -0.178913493 -0.332647539  0.100189664 -0.2803642571
Humidity9am    0.11612125  0.088004600 -0.339977573  0.117385241 -0.2615641274
Humidity3pm    0.10073257 -0.087575723 -0.333963546 -0.135423221 -0.1485592784
Pressure9am    0.29713512 -0.284593598  0.175358349 -0.203360826 -0.1770757787
Pressure3pm    0.34443626 -0.320415358  0.179433343 -0.189436249 -0.1730467614
Cloud9am       0.13937691 -0.148505321  0.173660559  0.315565534 -0.0002812937
Cloud3pm       0.02634882 -0.083285009  0.301489502  0.106654120  0.0687742937
Temp9am        0.15594535 -0.140940288 -0.064903499 -0.086018149 -0.1370145361
Temp3pm        0.11987107 -0.003513382  0.050829775 -0.003574371 -0.1176451996
RainToday     -0.08310110 -0.048469467 -0.147688422 -0.090760686  0.0155161296
RainTomorrow   0.14199040 -0.187886576 -0.031042437  0.844712577 -0.0213304968
                      PC11         PC12         PC13         PC14         PC15
Location       0.055089537 -0.052328991  0.121229136  0.090544862 -0.067517112
MinTemp       -0.154091728 -0.045286696 -0.021889373 -0.021896384 -0.037378273
MaxTemp        0.072384523  0.105413748 -0.081065102 -0.153765534  0.040961249
Rainfall       0.306665440 -0.504345070 -0.203981103 -0.134394265  0.022019198
Evaporation    0.060954162 -0.228575926  0.480485411  0.573814696 -0.126749082
Sunshine      -0.009389857  0.019398504  0.081760022  0.044807751  0.003518864
WindGustDir   -0.047330777 -0.008291596  0.079608783  0.133613837  0.740618844
WindGustSpeed  0.215112205  0.103618694  0.010700431  0.019418160 -0.004366222
WindDir9am    -0.038656256 -0.076439222  0.056652588  0.109958325 -0.236188812
WindDir3pm     0.121140149  0.121520975 -0.047849748 -0.117098398 -0.587600112
WindSpeed9am  -0.640468498 -0.196613502 -0.021585796 -0.291157153 -0.035050869
WindSpeed3pm   0.450630252  0.054377597 -0.045738090  0.136409714  0.039856193
Humidity9am   -0.020979066 -0.131618305  0.230544047 -0.037455157 -0.015277454
Humidity3pm   -0.227525842 -0.289893741 -0.059382654  0.333181638 -0.100280480
Pressure9am    0.130734699  0.069704535 -0.021534678 -0.036714900 -0.011273980
Pressure3pm    0.073088416  0.049674712  0.003671369  0.042225637 -0.009558404
Cloud9am       0.177748748  0.049838755  0.523073019 -0.385234331  0.033523390
Cloud3pm       0.071863755  0.167786443 -0.529503385  0.276727357  0.035726035
Temp9am       -0.043914692  0.022813735 -0.163383529  0.009608881 -0.003073992
Temp3pm        0.073644667  0.125705534 -0.057577778 -0.225879777  0.051774157
RainToday      0.234767314 -0.664182658 -0.155946531 -0.221928251  0.040948740
RainTomorrow  -0.135334814 -0.085420416 -0.138284105  0.173318310 -0.078214067
                       PC16        PC17         PC18          PC19         PC20
Location       0.0860858657 -0.01440848 -0.019546007  3.217874e-03 -0.010226540
MinTemp       -0.1030825299 -0.12232575  0.057832144 -6.844436e-01 -0.370556853
MaxTemp        0.1789570095 -0.04563485 -0.045366695  4.152610e-01 -0.194227784
Rainfall      -0.0375571618  0.04676859  0.039864210 -2.035183e-02 -0.002744731
Evaporation    0.1707201222  0.02950689 -0.132876716  4.054424e-02  0.017510575
Sunshine       0.1970947700  0.57031643  0.587389464 -7.403348e-02 -0.037017639
WindGustDir   -0.0027948164 -0.02515829  0.020223163 -1.434848e-02  0.004798676
WindGustSpeed  0.1907959963 -0.57948561  0.496810413  1.751086e-02  0.013725753
WindDir9am    -0.1090966958  0.03241369  0.007253634 -6.259629e-02  0.003758483
WindDir3pm     0.0548372675  0.03193405 -0.003278571 -9.140858e-06  0.022882007
WindSpeed9am   0.1589069431  0.17485923 -0.129343120  8.149659e-02  0.032272138
WindSpeed3pm  -0.1527394509  0.29581593 -0.390870618  6.188037e-03 -0.042289977
Humidity9am    0.6814381792 -0.08632590 -0.153984493 -8.577774e-02  0.213291359
Humidity3pm   -0.2356615056 -0.00913466  0.264556460  4.635499e-01 -0.215121655
Pressure9am    0.0439038194 -0.05763133  0.015854578  9.420350e-02 -0.267656158
Pressure3pm   -0.0001309828 -0.04492173  0.091044831 -8.743015e-02  0.267183357
Cloud9am      -0.1822467380  0.22327729  0.261580819  8.380463e-02  0.012776448
Cloud3pm       0.3569275177  0.30997235  0.127903476 -7.303688e-02 -0.015831774
Temp9am       -0.2087695710 -0.01844499  0.088102500  4.701597e-02  0.745372331
Temp3pm        0.2150261497 -0.04220873 -0.116233595  2.830121e-01 -0.168105250
RainToday      0.0841022309 -0.01959904  0.056350024 -4.949746e-02  0.019042155
RainTomorrow  -0.0361561981 -0.19110536  0.040838331  6.757629e-02 -0.013490991
                      PC21          PC22
Location      -0.016171119  0.0024691661
MinTemp       -0.049392609 -0.0347288938
MaxTemp       -0.322444163 -0.6249559911
Rainfall      -0.000875466 -0.0052817864
Evaporation    0.041956764  0.0126809974
Sunshine       0.025242272  0.0050664725
WindGustDir   -0.014713758 -0.0028370557
WindGustSpeed  0.026918889  0.0225801041
WindDir9am    -0.015472348  0.0034287002
WindDir3pm    -0.036470533  0.0002292953
WindSpeed9am   0.016017980 -0.0164423442
WindSpeed3pm  -0.028700519  0.0009791524
Humidity9am    0.068057371 -0.0605945457
Humidity3pm   -0.064271428  0.1170545262
Pressure9am    0.629849993 -0.1482926254
Pressure3pm   -0.622754544  0.1409427858
Cloud9am       0.012823230 -0.0060530615
Cloud3pm       0.017191622  0.0133633472
Temp9am        0.304862807 -0.0660682429
Temp3pm        0.011982637  0.7371082201
RainToday     -0.016907512  0.0073941447
RainTomorrow   0.014552813 -0.0031541648

$center
     Location       MinTemp       MaxTemp      Rainfall   Evaporation      Sunshine 
    23.535271     13.464770     24.219206      2.130397      5.503135      7.735626 
  WindGustDir WindGustSpeed    WindDir9am    WindDir3pm  WindSpeed9am  WindSpeed3pm 
     8.514463     40.877366      8.877065      8.425576     15.667228     19.786778 
  Humidity9am   Humidity3pm   Pressure9am   Pressure3pm      Cloud9am      Cloud3pm 
    65.874123     49.601985   1017.239505   1014.795580      4.241705      4.326515 
      Temp9am       Temp3pm     RainToday  RainTomorrow 
    18.204961     22.710333      1.779121      1.779741 

$scale
     Location       MinTemp       MaxTemp      Rainfall   Evaporation      Sunshine 
   12.7653431     6.4166888     6.9706764     7.0148222     3.6962823     3.7581533 
  WindGustDir WindGustSpeed    WindDir9am    WindDir3pm  WindSpeed9am  WindSpeed3pm 
    4.7923048    13.3352315     4.6608232     4.7117002     8.3170048     8.5101805 
  Humidity9am   Humidity3pm   Pressure9am   Pressure3pm      Cloud9am      Cloud3pm 
   18.5132892    20.1970399     6.9093568     6.8708917     2.7971623     2.6472513 
      Temp9am       Temp3pm     RainToday  RainTomorrow 
    6.5679912     6.8365431     0.4148428     0.4144248 

$x
                 PC1           PC2           PC3           PC4           PC5
5940   -4.652543e+00 -4.870167e-01 -7.038244e-01 -1.457484e+00  9.776513e-01
5941   -3.773326e+00  9.726445e-01 -1.451344e+00 -1.142741e+00 -1.358571e-01
5943   -4.367949e+00 -6.431089e-01 -3.396659e-02  3.080533e-01  2.133253e-01
5944   -4.007751e+00  1.760281e-01  1.780658e-01 -3.945148e+00  1.029088e+00
5945   -4.991261e+00 -8.488209e-01 -1.678108e-01 -2.492305e+00  1.325926e+00
5946   -3.712435e+00 -2.436934e+00  1.358626e+00 -6.530875e-01  2.492807e+00
5947   -4.090135e+00  6.503832e-02 -8.265623e-01 -1.533871e+005
5948   -4.395361e+00  1.279509e+00 -5.005089e-01 -1.709341e+00  3.580774e-02
5949   -4.245954e+00 -6.869232e-01 -3.946964e-01 -1.037768e-01  3.110072e-01
5950   -3.920942e+00 -3.741422e-01 -1.830697e-01 -1.363245e+00  3.776233e-01
5951   -5.640804e+00  1.225524e+00  1.506930e+00 -7.393319e-01 -5.592939e-01
5952   -5.631751e+00  3.759089e-01  1.008740e+00  2.043919e-01 -4.992189e-01
5953   -5.941057e+00 -3.176776e-02  2.785461e-01 -1.158019e+00  2.885427e-01
5954   -5.100732e+00 -1.311826e+00 -5.754010e-01 -2.254356e+00  1.359174e+00
5955   -5.229984e+00  7.666749e-01 -1.438590e+00 -1.356192e+00 -1.578301e-01
5956   -4.220364e+00  1.547287e+00 -1.115361e+00 -1.449344e+00 -9.037268e-02
5957   -3.713974e+00  3.301074e-01 -1.216516e+00 -9.844393e-02 -1.967654e-01
5958   -3.699969e+00 -1.840801e+00  1.283058e+00  7.721016e-01  1.294303e+00
5959   -4.058566e+00 -1.880113e+00 -2.692054e-01 -1.094093e+00 -9.898781e-01
5960   -3.112399e+00 -1.909732e+00  1.387695e+00  4.723132e-01  1.082879e+00
5961   -1.192036e+00 -3.264251e+00  5.627564e-01  4.399158e-01  1.323174e+00
5962   -1.474895e+00 -4.122164e+00  1.306061e-01 -1.373386e+00 -1.979791e+00
5963   -3.228392e+00 -1.601502e+00  6.994703e-02 -2.170566e+00 -1.398900e+00
5964   -5.165926e+00  1.320397e+00  5.568772e-01 -1.642347e+00 -7.028744e-02
5965   -5.445956e+00  9.818325e-01  1.592024e+00 -5.592312e-01 -5.506243e-01
5966   -5.508795e+00  1.524481e-01  1.378289e+00  7.035373e-01 -4.172159e-01
5967   -5.883511e+00  3.700823e-01  1.142102e+00  3.213123e-01 -6.446264e-01
5968   -6.183910e+00  1.531949e-01  4.383601e-02  2.685100e-01 -6.868172e-01
5969   -6.145549e+00  1.263296e-01  4.199169e-01  3.216090e-01 -6.786854e-01
5970   -5.839426e+00  3.239329e-03  2.710240e-01  5.398332e-01 -4.926220e-01
5971   -4.836489e+00 -1.846611e-01  9.608022e-01 -2.763562e+00  9.044417e-01
5972   -5.702183e+00 -1.155246e+00  5.784037e-01 -7.587937e-01  5.521527e-01
5973   -5.065407e+00 -1.227911e+00  2.156107e-02 -1.954725e+00  5.056713e-01
5974   -4.988510e+00 -1.191537e+00  8.526699e-01 -1.906617e+00 -1.076461e+00
5975   -6.736426e+00 -6.495210e-01  1.499444e+00 -1.135037e+00  2.453272e-01
5976   -6.465441e+00 -5.144638e-01  9.618665e-01 -2.680218e+00  5.420478e-01
5977   -6.910680e+00 -3.015801e-01  4.983870e-01 -1.748214e-01 -4.419698e-01
5978   -6.943265e+00  1.008659e-01  6.052550e-01 -8.317357e-01 -1.301332e-01
5979   -4.627054e+00 -1.188986e+00 -6.010992e-01 -2.010884e+00  1.339266e+00
5980   -2.831162e+00 -9.643959e-01 -1.528821e+00 -6.903074e-01  1.376385e+00
5981   -2.614375e+00  9.117913e-01 -2.445127e+00 -8.985708e-01 -4.715997e-01
5982   -1.862319e+00  1.621235e-01  3.048074e-01 -1.149932e+00  1.108007e+00
5983   -3.463032e-01 -2.802543e+00 -9.023517e-03  4.087829e+00  4.780114e-01
5984    2.321148e+00 -3.935855e+00  1.679901e+00  1.996218e+00 -2.586096e+00
5985    5.723001e-01 -1.471736e+00  6.502604e-01 -2.948205e-01 -1.363236e+00
                 PC6           PC7           PC8           PC9          PC10
5940   -1.4945399385  7.521408e-01  1.508430e+00  3.687180e-01 -4.264888e-01
5941   -0.7210727626 -8.159643e-01  9.189161e-01 -3.413834e-01  1.004446e+00
5943   -0.6312045741 -8.053855e-01  1.266124e+00 -3.486519e-02  1.942368e-01
5944   -0.2372774124 -7.929443e-01  1.036217e+00 -5.360624e-01  4.582475e-01
5945   -0.3274493386 -6.913708e-01  2.019875e+00 -3.399150e-01 -2.910373e-01
5946   -0.3142973264 -6.353336e-01  2.520972e+00  1.043839e+00 -2.038223e-01
5947   -0.6129630075 -7.133215e-01  5.128748e-01 -2.957892e-02 -8.386846e-02
5948   -1.0060945971 -2.082366e-01  1.431283e+00 -4.455744e-01  1.420698e+00
5949   -1.3441418175  4.427900e-01  1.656217e+00  2.291625e-01 -4.684612e-01
5950   -1.0902041580  3.314024e-01  7.001921e-01  4.308925e-01 -5.760076e-01
5951   -0.8343840979 -5.045281e-01  4.262540e-01 -4.268473e-01  1.799446e+00
5952   -0.4688861777 -5.197916e-01  9.837929e-01 -3.978086e-01  6.368923e-01
5953   -0.2165511290 -4.060798e-01  1.601073e+00 -5.171858e-01 -1.186657e-02
5954    0.4744989934 -1.719518e+00  1.497983e+00 -1.684194e-01  5.918561e-01
5955   -0.2678402116 -8.436376e-01  1.202463e+00 -8.086362e-01  7.071794e-01
5956   -0.5128798918 -6.220800e-01  1.619492e+00 -6.553844e-01  6.694372e-01
5957   -0.5539166534 -4.978904e-01  1.169667e+00 -3.542890e-01 -4.618853e-01
5958   -0.6143299525 -2.635297e-01  2.626182e+00 -1.555187e+00  4.724877e-01
5959   -0.1802047105 -1.039060e-01  1.901173e+00  3.577177e-01 -5.696361e-01
5960   -0.0237613167 -1.393128e+00  1.531297e-01  3.477513e-01  4.806418e-01
5961   -0.9643088942 -2.258531e-01  2.804843e-01 -1.123998e+00 -5.392776e-01
5962   -0.5735752602  7.915387e-01  1.228529e+00 -9.381060e-01 -6.583147e-01
5963   -0.4710150806 -4.537702e-01  1.064193e+00  4.990674e-01  3.301381e-01
5964   -0.6015545380 -6.252797e-01  1.096226e+00 -6.170038e-01  1.724560e+00
5965   -0.3947842250 -1.407678e-02  7.283361e-01 -4.404435e-01  7.194733e-04
5966   -0.1938926708 -5.294513e-01  1.198220e+00 -3.716679e-01  1.655493e-01
5967   -0.2132065285 -7.934882e-01  2.305688e-01 -3.672294e-01  6.122056e-01
5968   -0.2154972944 -8.168342e-01  5.647362e-01 -5.066141e-01  1.850923e-01
5969   -0.1696593715 -8.436775e-01  3.878411e-01 -4.822052e-01  5.331060e-01
5970    0.0466239314 -1.115424e+00  8.139430e-01 -4.099688e-01  3.944803e-01
5971    0.1928794120 -1.243744e+00  1.068634e+00 -1.001708e-01  8.733900e-01
5972   -0.1871629276 -6.472076e-01  1.254904e+00  1.843584e-02  3.884486e-01
5973   -1.2356639468  1.277930e+00  1.237993e+00 -2.136395e+00 -1.135945e+00
5974   -0.7391319656  6.173956e-01  1.489287e+00  2.853221e-01 -3.590423e-01
5975   -0.7730689144  2.383651e-01  9.559269e-01 -1.005733e-02  6.113764e-01
5976   -0.2950723034 -2.566426e-01  6.486911e-01 -3.301473e-01  8.210174e-02
5977   -0.1725541861 -8.218574e-01  4.742229e-01 -4.033713e-01  6.650556e-01
5978   -0.4729635769 -6.214659e-02  1.219401e+00 -4.459369e-01  5.375094e-01
5979   -0.1995827593 -1.134308e+00  1.821151e+00  1.351736e-01  1.008406e+00
5980   -0.5701589120 -1.009743e+00  1.875771e+00  5.846494e-01  8.582315e-01
5981   -1.2607119984 -6.566618e-01  1.359757e-02 -2.733441e-01  9.369777e-01
5982   -1.0463026960 -3.796784e-01  1.238772e+00  6.780086e-01  6.941498e-01
5983   -1.1409366219 -8.621460e-01  5.137352e-01 -7.893244e-01 -2.927733e-01
5984   -0.6447868415 -2.341437e-01  1.603860e+00 -5.936495e-01  2.706520e-01
5985   -0.9933493188 -7.573560e-01 -3.973568e-01  1.172558e+00  1.528059e-01
                PC11          PC12          PC13          PC14          PC15
5940    9.522990e-01  4.184853e-01 -3.439437e-01  9.602461e-01 -2.390136e-01
5941   -1.629212e-01 -3.430187e-01  9.362288e-01  7.063605e-01  1.237182e-01
5943   -1.087366e+00 -5.168323e-03 -8.373763e-01 -6.461807e-03 -3.722024e-03
5944   -8.153269e-02  2.745290e-01 -6.906734e-01  3.943732e-01  2.140619e-01
5945   -4.858759e-01  3.288880e-01 -1.352507e+00  9.221193e-02 -1.933064e-01
5946    9.454384e-01  3.815984e-01  6.558717e-02  6.622318e-01  1.327510e+00
5947   -6.929648e-02  3.826199e-02  4.241948e-01 -4.773168e-01 -2.373489e-01
5948   -3.528680e-01 -7.253235e-02  7.894749e-01  2.619091e-01 -2.770813e-01
5949   -1.885621e+00 -7.306926e-01  8.898769e-03  6.048505e-01  1.413362e+00
5950   -2.397970e-01 -1.387287e-01 -1.020430e-02  6.599840e-01  1.343269e+00
5951   -2.128362e-01  3.360790e-01  1.589360e-01  1.468054e-01  3.288423e-01
5952   -1.107083e+00 -1.837156e-01  2.204816e-01  1.327627e-01  5.261932e-02
5953   -2.851751e-01  1.238293e-01 -3.740497e-02  3.174748e-01 -1.112108e+00
5954    8.281517e-01  4.136953e-01 -5.173021e-02  6.593235e-01  7.054710e-02
5955    1.703623e-01 -1.958502e-01  8.638828e-01  8.348749e-01 -8.971087e-01
5956   -2.065402e-01 -3.009615e-01  8.564417e-01  9.055629e-01  2.628950e-01
5957   -8.822116e-02 -1.257527e-01  4.243127e-01  1.966215e-01 -3.841871e-01
5958   -4.612319e-01 -3.715635e-02  1.077249e+00 -4.171391e-01 -2.685272e-01
5959   -1.924625e-01  1.615328e+00 -5.420497e-01  7.369444e-01 -1.238947e+00
5960    9.875238e-01 -6.787274e-02 -2.705523e-01  1.649017e+00 -1.221742e-01
5961   -1.812848e-01 -3.042625e-01  2.920434e-01 -6.190316e-01 -1.790962e+00
5962    9.844560e-01  5.000469e-01  1.141200e+00 -9.449103e-01 -1.317907e+00
5963   -2.614954e-02  1.383465e+00 -6.357623e-01  6.891819e-01  9.438720e-01
5964   -2.006694e-01  2.413883e-01  3.511890e-01 -6.996352e-02 -1.425930e+00
5965   -6.851816e-01 -5.678536e-02  3.067069e-01 -2.152092e-01 -1.502775e+00
5966   -1.119439e+00 -2.476844e-01  3.612045e-01  3.247599e-01 -2.926282e-01
5967    1.184333e-01  1.009921e-01  2.458894e-01  7.488935e-01  3.942213e-02
5968    4.566423e-02  8.650877e-02  3.776518e-01  5.103571e-01  3.973430e-01
5969   -1.378130e-01 -1.086130e-01  5.061284e-01  6.364540e-01 -2.030821e-01
5970   -3.805055e-01 -2.103648e-01  6.147133e-01  6.366798e-01  1.812325e-01
5971    2.025331e-01  3.296013e-01  6.070605e-01 -3.455716e-01  3.185064e-01
5972   -1.435787e-01  1.030041e-01  9.143976e-01 -3.638289e-01 -6.801652e-01
5973    5.314470e-01  2.788883e-01  3.874568e-01 -3.213489e-01 -9.507555e-01
5974   -1.677145e+00  1.137161e+00  2.525470e-01  1.132675e+00  1.552653e+00
5975   -6.104437e-01  1.513428e-01 -3.095049e-02  2.762920e-02 -6.462950e-01
5976   -3.965677e-02  2.826519e-01 -3.388589e-01 -9.439090e-02 -1.305548e+00
5977   -2.357698e-01  7.959304e-03  5.578308e-01  5.246015e-02 -7.437658e-01
5978   -1.873718e-01 -3.399079e-02  5.631043e-01  6.980634e-01 -3.574467e-01
5979   -1.970173e-01  9.482545e-02  4.417207e-01  1.203327e-02 -1.987451e-01
5980    5.337345e-01 -2.688756e-01  1.437848e+00  5.788631e-01 -2.730920e-01
5981   -1.542953e-01 -4.663761e-01  6.702177e-01  3.618467e-01 -6.698968e-01
5982    5.903190e-01  2.657555e-01  3.842665e-01  1.475799e-01  1.628071e-01
5983    1.914178e-01 -3.777358e-01  5.712017e-01 -2.173683e-01 -1.404774e-01
5984   -2.730009e-01 -1.381408e+00  2.359122e-01  4.128626e-01 -3.884358e-01
5985    1.454017e-01  1.302542e+00 -7.777249e-01 -1.363045e-01 -8.238519e-01
                PC16          PC17          PC18          PC19          PC20
5940   -4.125788e-01  1.701324e-01  3.609940e-01 -2.023851e-01 -7.970739e-02
5941   -8.217401e-02  3.414570e-01 -4.475046e-01 -7.887270e-01 -2.031384e-01
5943    1.083204e+00  9.133239e-02 -9.711476e-02  2.105042e-01  2.284061e-01
5944    4.677118e-01 -5.781105e-02  3.170980e-01 -5.769263e-02 -1.178200e-01
5945   -2.603080e-01 -1.337133e-01 -4.936079e-01 -4.683679e-02  6.998672e-02
5946   -1.098484e+00 -9.497438e-01 -8.727491e-01 -6.162585e-01  5.505408e-03
5947   -4.274628e-01  5.706750e-02  5.875481e-02 -6.539684e-01 -2.846912e-01
5948    2.260411e-01 -1.293070e-01  1.148919e-01  3.855699e-02 -4.560567e-01
5949    1.151109e+00 -1.571674e-02  3.900048e-01  9.454747e-02 -3.268724e-01
5950    1.382965e+00  2.029118e-01 -2.013195e-01 -4.890837e-01 -1.923111e-02
5951   -1.807451e-03 -1.406806e-01 -5.094361e-02 -1.993969e-01  1.980104e-01
5952    7.641916e-01 -3.454035e-01 -1.885606e-01 -2.532800e-01  5.819146e-03
5953    2.019508e-01 -1.848776e-01  3.134769e-01 -1.581123e-01 -8.478984e-02
5954    1.795438e-01  1.757740e-01 -1.583080e-01 -4.785788e-02 -1.989307e-01
5955   -2.842316e-01 -2.183291e-01 -3.245611e-01 -5.017489e-01 -2.760232e-01
5956    2.911736e-03  1.960844e-01 -5.772106e-01 -5.726266e-01 -4.997343e-01
5957    8.916755e-01 -9.962540e-01  3.071375e-01 -2.979823e-02 -2.637676e-01
5958    3.251157e-01  3.734824e-01  3.900545e-02  1.759908e-01 -1.958672e-01
5959    1.577982e+00 -4.668334e-01  1.282715e-01 -2.772779e-01 -1.503314e-01
5960   -3.402495e-01 -6.602016e-01 -6.758129e-01 -1.758139e-01 -1.339591e-01
5961    7.360671e-01  2.785490e-02  4.106783e-01  7.400999e-04 -3.364547e-02
5962    1.989405e+00 -1.917889e+00  2.616277e+00  3.677011e-01  1.092946e-01
5963    4.873152e-01 -1.217567e-01  7.284585e-01 -3.921025e-01  9.332759e-02
5964   -1.903587e-01  1.985224e-01 -8.652982e-03 -4.771892e-02 -1.173801e-01
5965    8.391562e-01 -1.754900e-01 -2.317232e-01 -2.659549e-01  8.016888e-03
5966    1.013734e+00 -4.614857e-01  5.585102e-01 -5.455410e-01 -1.360001e-01
5967    3.617972e-01 -3.928029e-02 -2.489207e-01 -5.594133e-01 -1.803614e-01
5968    3.360878e-01 -5.422962e-01  9.439172e-02 -2.645735e-01 -1.893606e-01
5969    3.343115e-01 -1.987587e-01 -2.973328e-01 -2.251819e-01 -1.528652e-01
5970    5.030504e-01  3.553548e-02 -2.244224e-01 -2.732139e-01 -2.037279e-01
5971    5.152350e-02  4.836367e-02  1.033643e-01  6.272524e-03 -1.966368e-01
5972    8.449760e-02 -1.049219e+00  9.395503e-01 -1.739566e-01 -8.751244e-02
5973    4.930680e-01 -5.989018e-01  4.470504e-01 -3.296504e-01 -4.682043e-02
5974    9.374270e-01 -3.071934e-01 -1.022023e-01 -7.964671e-03 -3.191985e-01
5975    5.334596e-01 -2.022393e-01  3.487968e-02 -1.746573e-01 -1.383907e-01
5976   -4.754463e-01  4.473478e-02 -3.968512e-01 -3.132410e-01 -5.480752e-02
5977   -3.277365e-01 -2.026657e-01 -3.842343e-01 -3.712179e-01 -2.738569e-01
5978    5.820330e-02 -2.697193e-01 -3.024025e-01 -1.571978e-01 -1.068807e-01
5979    1.513612e-01  1.045742e-01  1.363032e-01 -4.642977e-01 -4.684658e-01
5980   -6.376805e-01  2.000548e-01 -4.614919e-01 -6.448571e-01 -3.458682e-01
5981    1.586057e-02  8.715878e-02 -6.140034e-01 -3.970435e-01 -4.960700e-01
5982    2.987187e-01  4.353905e-01  3.866421e-01 -2.322503e-02 -4.926111e-01
5983    4.130739e-01  7.230544e-02 -7.227777e-01 -2.480668e-01  2.960762e-02
5984   -1.949472e-01 -4.211498e-01 -1.750346e-02  2.018626e-01 -8.281536e-02
5985   -3.614991e-01  3.887216e-02  4.005283e-02 -7.184710e-02 -1.550346e-01
                PC21          PC22
5940   -1.431864e-01  1.002896e-01
5941   -1.855224e-01 -6.988852e-02
5943   -1.718124e-02 -8.936373e-02
5944    6.559636e-02 -7.899096e-02
5945    2.124700e-02 -1.375033e-01
5946   -2.399588e-01  4.448959e-02
5947   -2.342876e-01 -1.038272e-01
5948   -8.702047e-02  5.022240e-02
5949    2.343387e-02 -1.306242e-02
5950   -1.096693e-01 -6.060273e-02
5951   -1.318656e-01  1.220607e-02
5952   -1.049985e-01 -7.099605e-02
5953   -1.213439e-01 -7.738005e-02
5954    2.719320e-02 -4.183342e-02
5955   -1.576749e-01 -8.734196e-03
5956   -1.666563e-01 -4.943878e-03
5957   -1.417279e-01  2.891967e-03
5958   -1.620065e-01 -8.605051e-02
5959   -9.580239e-02 -6.429696e-02
5960   -1.373586e-01 -9.803593e-02
5961   -9.018726e-02 -7.939478e-02
5962   -4.810836e-02  2.823073e-02
5963   -1.065433e-01  4.105644e-02
5964   -3.420843e-01  4.868852e-03
5965   -2.334665e-01  3.048918e-02
5966   -1.486523e-01 -6.125676e-02
5967   -1.650551e-01  1.419895e-02
5968   -9.265764e-02  8.074569e-02
5969   -1.203749e-01  6.065410e-03
5970   -8.749631e-02  1.253202e-02
5971   -9.441744e-02 -1.367407e-03
5972   -4.860396e-03  2.734820e-02
5973   -7.267429e-02  5.959437e-02
5974   -8.272238e-02 -7.275659e-02
5975   -2.209038e-01  1.968700e-01
5976   -1.815280e-01  7.200586e-03
5977   -2.909436e-01  7.663586e-02
5978   -1.920630e-01  7.041002e-02
5979   -1.806988e-01  9.798085e-02
5980   -1.378292e-01 -1.665512e-01
5981   -2.384437e-01 -2.357512e-02
5982   -1.652990e-01  4.007328e-02
5983   -1.672565e-01  9.273881e-02
5984   -1.024216e-01  4.897201e-02
5985   -2.258790e-01  3.446901e-02
 [ reached getOption("max.print") -- omitted 56375 rows ]

> par(data_PCA)
Warning messages:
1: In par(data_PCA) : "sdev" is not a graphical parameter
2: In par(data_PCA) : "rotation" is not a graphical parameter
3: In par(data_PCA) : "center" is not a graphical parameter
4: In par(data_PCA) : "scale" is not a graphical parameter
5: In par(data_PCA) : "x" is not a graphical parameter
> biplot(data_PCA, cex=0.5, cex.axis=0.5)
> 
> screeplot(data_PCA, type = "l", npcs = 15, main = "Screeplot of the first 10 PCs")
> abline(h = 1, col="red", lty=5)
> legend("topright", legend=c("Eigenvalue = 1"),
+        col=c("red"), lty=5, cex=0.6)
> 
> cumpro <- cumsum(data_PCA$sdev^2 / sum(data_PCA$sdev^2))
> plot(cumpro[0:15], xlab = "PC #", ylab = "Amount of explained variance", main = "Cumulative variance plot")
> abline(v = 6, col="blue", lty=5)
> abline(h = 0.88759, col="blue", lty=5)
> legend("topleft", legend=c("Cut-off @ PC6"),
+        col=c("blue"), lty=5, cex=0.6)
> 
> cor(data,data$RainTomorrow)
                      [,1]
Location      -0.004778288
MinTemp       -0.087427773
MaxTemp        0.147466714
Rainfall      -0.254341698
Evaporation    0.130002265
Sunshine       0.453406913
WindGustDir    0.061750762
WindGustSpeed -0.233158169
WindDir9am     0.035991956
WindDir3pm     0.032202530
WindSpeed9am  -0.083904488
WindSpeed3pm  -0.088861671
Humidity9am   -0.271032960
Humidity3pm   -0.455357637
Pressure9am    0.254815656
Pressure3pm    0.230417506
Cloud9am      -0.323972381
Cloud3pm      -0.388574211
Temp9am        0.018179123
Temp3pm        0.183586164
RainToday      0.309098228
RainTomorrow   1.000000000
> keep <-c('MaxTemp','Evaporation','Sunshine','Pressure9am','Temp3pm','RainToday','RainTomorrow')
> data <-data[ , (names(data) %in% keep)]
> #First, we convert rank to a factor to indicate that rank should be treated as a categorical variable.
> data$RainToday[which(data$RainToday == 2)]<- 0 
> data$RainTomorrow[which(data$RainTomorrow == 2)]<- 0 
> data$RainToday <- factor(data$RainToday)
> 
> 
> # Check distribution between the 2 binary classes
> table(data$RainTomorrow)

    0     1 
43993 12427 
> xtabs(~RainTomorrow + RainToday, data = data)
            RainToday
RainTomorrow     0     1
           0 37274  6719
           1  6684  5743
> xtabs(~RainTomorrow + Location, data = data)
Error in eval(predvars, data, env) : object 'Location' not found
> 
> 
> # Create Training Data
> input_ones <- data[which(data$RainTomorrow == 1), ]  # all 1's
> input_zeros <- data[which(data$RainToday == 0), ]  # all 0's
> set.seed(123)  # for repeatability of samples
> input_ones_training_rows <- sample(1:nrow(input_ones), 0.8*nrow(input_ones))  # 1's for training
> input_zeros_training_rows <- sample(1:nrow(input_zeros), 0.8*nrow(input_ones))  # 0's for training. Pick as many 0's as 1's
> training_ones <- input_ones[input_ones_training_rows, ]  
> training_zeros <- input_zeros[input_zeros_training_rows, ]
> trainingData <- rbind(training_ones, training_zeros)  # row bind the 1's and 0's 
> 
> # Create Test Data
> test_ones <- input_ones[-input_ones_training_rows, ]
> test_zeros <- input_zeros[-input_zeros_training_rows, ]
> testData <- rbind(test_ones, test_zeros)  # row bind the 1's and 0's 
> start_time <- Sys.time()
> # apply logistic regression
> logit <- glm(RainTomorrow ~ ., data=trainingData)  # build the model
> summary(logit)

Call:
glm(formula = RainTomorrow ~ ., data = trainingData)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.18983  -0.26961  -0.07667   0.28668   0.97118  

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) 14.3921799  0.4265864   33.74   <2e-16 ***
MaxTemp      0.0329616  0.0019287   17.09   <2e-16 ***
Evaporation -0.0108851  0.0009809  -11.10   <2e-16 ***
Sunshine    -0.0485185  0.0008168  -59.40   <2e-16 ***
Pressure9am -0.0133659  0.0004165  -32.09   <2e-16 ***
Temp3pm     -0.0327380  0.0019173  -17.07   <2e-16 ***
RainToday1   0.3128933  0.0069882   44.77   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.1395016)

    Null deviance: 4857.0  on 19881  degrees of freedom
Residual deviance: 2772.6  on 19875  degrees of freedom
AIC: 17271

Number of Fisher Scoring iterations: 2

> 
> # CIs using standard errors
> confint.default(logit)
                  2.5 %       97.5 %
(Intercept) 13.55608605 15.228273850
MaxTemp      0.02918146  0.036741764
Evaporation -0.01280759 -0.008962691
Sunshine    -0.05011937 -0.046917538
Pressure9am -0.01418229 -0.012549448
Temp3pm     -0.03649575 -0.028980255
RainToday1   0.29919660  0.326589973
> #To get the exponentiated coefficients, you tell R that you want to exponentiate (exp)
> ## odds ratios only
> exp(coef(logit))
 (Intercept)      MaxTemp  Evaporation     Sunshine  Pressure9am      Temp3pm 
1.780100e+06 1.033511e+00 9.891739e-01 9.526398e-01 9.867231e-01 9.677921e-01 
  RainToday1 
1.367376e+00 
> with(logit, null.deviance - deviance)
[1] 2084.436
> distPred <- plogis(predict(logit, testData))  # predict distance
> library(InformationValue)
> optCutOff <- optimalCutoff(testData$RainTomorrow, distPred)[1] 
> optCutOff
[1] 0.6690327
> misClassError(testData$RainTomorrow, distPred, threshold = optCutOff)
[1] 0.1535
> library(MLmetrics)
> testData$RainTomorrow <- factor(testData$RainTomorrow)
> distPred <- ifelse(distPred < optCutOff, 0 ,1)
> distPred<-factor(distPred)
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(distPred))
> AUC(testData$RainTomorrow, distPred)
[1] 0.7941558
> recall(testData$RainTomorrow, distPred)
[1] 0.8642335
> precision(testData$RainTomorrow, distPred)
[1] 0.9558869
> F_meas(testData$RainTomorrow, distPred)
[1] 0.9077526
> 
> confusionMatrix(testData$RainTomorrow, distPred)
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 27563  1272
         1  4330  3338
                                          
               Accuracy : 0.8465          
                 95% CI : (0.8428, 0.8502)
    No Information Rate : 0.8737          
    P-Value [Acc > NIR] : 1               
                                          
                  Kappa : 0.4583          
                                          
 Mcnemar's Test P-Value : <2e-16          
                                          
            Sensitivity : 0.8642          
            Specificity : 0.7241          
         Pos Pred Value : 0.9559          
         Neg Pred Value : 0.4353          
             Prevalence : 0.8737          
         Detection Rate : 0.7551          
   Detection Prevalence : 0.7899          
      Balanced Accuracy : 0.7942          
                                          
       'Positive' Class : 0               
                                          
> end_time <- Sys.time()
> #getting time difference
> end_time - start_time
Time difference of 1.14917 secs

> ##################################################################
> start_time <- Sys.time()
> #apply naive bayes algorithm
> trainingData$RainTomorrow <- factor(trainingData$RainTomorrow)
> nb_rain<-naive_bayes(RainTomorrow~.,data=trainingData)
Warning message:
naive_bayes(): Feature RainToday - zero probabilities are present. Consider Laplace smoothing. 
> nb_pred<-predict(nb_rain,testData)
Warning message:
predict.naive_bayes(): More features in the newdata are provided as there are probability tables in the object. Calculation is performed based on features to be found in the tables. 
> summary(nb_rain)

==================================== Naive Bayes ==================================== 
 
- Call: naive_bayes.formula(formula = RainTomorrow ~ ., data = trainingData) 
- Laplace: 0 
- Classes: 2 
- Samples: 19882 
- Features: 6 
- Conditional distributions: 
    - Bernoulli: 1
    - Gaussian: 5
- Prior probabilities: 
    - 0: 0.4245
    - 1: 0.5755

------------------------------------------------------------------------------------- 
> 
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(nb_pred))
> AUC(testData$RainTomorrow, nb_pred)
[1] 0.6796957
> recall(testData$RainTomorrow, nb_pred)
[1] 0.9053345
> precision(testData$RainTomorrow, nb_pred)
[1] 0.7780822
> F_meas(testData$RainTomorrow, nb_pred)
[1] 0.8368987
> # getting the confusion matrix and stastics
> confusionMatrix(testData$RainTomorrow, nb_pred)
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 22436  6399
         1  2346  5322
                                         
               Accuracy : 0.7604         
                 95% CI : (0.756, 0.7648)
    No Information Rate : 0.6789         
    P-Value [Acc > NIR] : < 2.2e-16      
                                         
                  Kappa : 0.3954         
                                         
 Mcnemar's Test P-Value : < 2.2e-16      
                                         
            Sensitivity : 0.9053         
            Specificity : 0.4541         
         Pos Pred Value : 0.7781         
         Neg Pred Value : 0.6941         
             Prevalence : 0.6789         
         Detection Rate : 0.6146         
   Detection Prevalence : 0.7899         
      Balanced Accuracy : 0.6797         
                                         
       'Positive' Class : 0              
                                         
> end_time <- Sys.time()
> #getting time difference
> end_time - start_time
Time difference of 1.598747 secs
> ######################################################################
> #apply decision tree alogorithm
> start_time <- Sys.time()
> 
> # Conditional partitioning is implemented in the "ctree" method
> rtree_fit2 <- ctree(trainingData$RainTomorrow ~ ., 
+                     trainingData) 
> plot(rtree_fit2)
> summary(rtree_fit2)
    Length      Class       Mode 
         1 BinaryTree         S4 
> 
> # We used the fit tree from the train data and test with the test data
> predicted= predict(rtree_fit2,testData)
> 
> summary(predicted)
    0     1 
22485 14018 
> 
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(predicted))
> AUC(testData$RainTomorrow, predicted)
[1] 0.6904111
> recall(testData$RainTomorrow, predicted)
[1] 0.9361797
> precision(testData$RainTomorrow, predicted)
[1] 0.7300156
> F_meas(testData$RainTomorrow, predicted)
[1] 0.8203429
> confusionMatrix(testData$RainTomorrow, predicted)
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 21050  7785
         1  1435  6233
                                          
               Accuracy : 0.7474          
                 95% CI : (0.7429, 0.7519)
    No Information Rate : 0.616           
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.4163          
                                          
 Mcnemar's Test P-Value : < 2.2e-16       
                                          
            Sensitivity : 0.9362          
            Specificity : 0.4446          
         Pos Pred Value : 0.7300          
         Neg Pred Value : 0.8129          
             Prevalence : 0.6160          
         Detection Rate : 0.5767          
   Detection Prevalence : 0.7899          
      Balanced Accuracy : 0.6904          
                                          
       'Positive' Class : 0               
                                          
> end_time <- Sys.time()
> #getting time difference
> end_time - start_time
Time difference of 3.8573 secs
> 
> formulas <- as.formula(trainingData$RainTomorrow ~ .)
> #tree construction based on information gain
> tree = rpart(formulas, data=trainingData, method = 'class', parms = list(split = "information"))
> rpart.plot(tree)
> ########################################################################
> # Fitting K-NN to the Training set and Predicting the Test set results
> start_time <- Sys.time()
> library(class)
> kn_pred = knn(train = trainingData,
+               test = testData,
+               cl = trainingData$RainTomorrow,
+               k = 5,
+               prob = TRUE)
> 
> 
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(kn_pred))
> AUC(testData$RainTomorrow, kn_pred)
[1] 0.8037411
> recall(testData$RainTomorrow, kn_pred)
[1] 0.9742783
> precision(testData$RainTomorrow, kn_pred)
[1] 0.8590949
> F_meas(testData$RainTomorrow, kn_pred)
[1] 0.9130683
> 
> #Confusion matrix   
> knn_confusion<-confusionMatrix(factor(kn_pred), factor(testData$RainTomorrow),positive="1")
> knn_confusion
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 24772   654
         1  4063  7014
                                          
               Accuracy : 0.8708          
                 95% CI : (0.8673, 0.8742)
    No Information Rate : 0.7899          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.6653          
                                          
 Mcnemar's Test P-Value : < 2.2e-16       
                                          
            Sensitivity : 0.9147          
            Specificity : 0.8591          
         Pos Pred Value : 0.6332          
         Neg Pred Value : 0.9743          
             Prevalence : 0.2101          
         Detection Rate : 0.1921          
   Detection Prevalence : 0.3035          
      Balanced Accuracy : 0.8869          
                                          
       'Positive' Class : 1               
                                          
> 
> 
> 
> end_time <- Sys.time()
> #getting time difference
> end_time - start_time
Time difference of 6.353632 secs
> #############################################################################
> # svm
> start_time <- Sys.time()
> library(e1071)
> svmfit = svm(formula = RainTomorrow ~ .,
+              data = trainingData,
+              type = 'C-classification',
+              kernel = 'linear')
> 
> # Predicting the Test set results
> y_pred_svm = predict(svmfit, newdata = testData)
> 
> 
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(y_pred_svm))
> AUC(testData$RainTomorrow, y_pred_svm)
[1] 0.7117446
> recall(testData$RainTomorrow, y_pred_svm)
[1] 0.9184332
> precision(testData$RainTomorrow, y_pred_svm)
[1] 0.8098838
> F_meas(testData$RainTomorrow, y_pred_svm)
[1] 0.8607497
> 
> # Making the Confusion Matrix and stastics
> confusionMatrix(testData$RainTomorrow, y_pred_svm)
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 23353  5482
         1  2074  5594
                                          
               Accuracy : 0.793           
                 95% CI : (0.7888, 0.7971)
    No Information Rate : 0.6966          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.4638          
                                          
 Mcnemar's Test P-Value : < 2.2e-16       
                                          
            Sensitivity : 0.9184          
            Specificity : 0.5051          
         Pos Pred Value : 0.8099          
         Neg Pred Value : 0.7295          
             Prevalence : 0.6966          
         Detection Rate : 0.6398          
   Detection Prevalence : 0.7899          
      Balanced Accuracy : 0.7117          
                                          
       'Positive' Class : 0               
                                          
> end_time <- Sys.time()
> #getting time difference
> end_time - start_time
Time difference of 17.52726 secs
> ###############################################################################
> 
> ############ ensemble methods
> #Taking average of predictions
> predicted_dt<-predicted
> library(varhandle)
> testData$pred_avg<-(unfactor(distPred)+unfactor(predicted_dt)+unfactor(kn_pred)+unfactor(nb_pred)+unfactor(y_pred_svm))/5
> 
> #Splitting into binary classes at 0.5
> testData$pred_avg<-as.factor(ifelse(testData$pred_avg>0.5,1, 0))
> confusionMatrix(testData$RainTomorrow, testData$pred_avg)
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 24079  4756
         1  2000  5668
                                          
               Accuracy : 0.8149          
                 95% CI : (0.8109, 0.8189)
    No Information Rate : 0.7144          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.5073          
                                          
 Mcnemar's Test P-Value : < 2.2e-16       
                                          
            Sensitivity : 0.9233          
            Specificity : 0.5437          
         Pos Pred Value : 0.8351          
         Neg Pred Value : 0.7392          
             Prevalence : 0.7144          
         Detection Rate : 0.6596          
   Detection Prevalence : 0.7899          
      Balanced Accuracy : 0.7335          
                                          
       'Positive' Class : 0               
                                          
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(testData$pred_avg))
> AUC(testData$RainTomorrow, testData$pred_avg)
[1] 0.7335276
> recall(testData$RainTomorrow, testData$pred_avg)
[1] 0.9233099
> precision(testData$RainTomorrow, testData$pred_avg)
[1] 0.8350616
> F_meas(testData$RainTomorrow, testData$pred_avg)
[1] 0.8769713
> 
> # majority voting
> #The majority vote
> # knn model, svm model, logistic regression selected for majority voting
> # as they have shown more than 82% accuracy
> testData$pred_majority<-as.factor(ifelse(unfactor(distPred)==1 & unfactor(kn_pred)==1,1,
+                                          ifelse(unfactor(distPred)==1 & unfactor(y_pred_svm)==1,1,
+                                                 ifelse(unfactor(kn_pred)==1 & unfactor(y_pred_svm)==1,1,
+                                                        ifelse(unfactor(kn_pred)==1 & unfactor(y_pred_svm)==1 &unfactor(distPred) == 1,1,0)))))
> confusionMatrix(testData$RainTomorrow, testData$pred_majority)
Confusion Matrix and Statistics

          Reference
Prediction     0     1
         0 25633  3202
         1  2153  5515
                                          
               Accuracy : 0.8533          
                 95% CI : (0.8496, 0.8569)
    No Information Rate : 0.7612          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.5791          
                                          
 Mcnemar's Test P-Value : < 2.2e-16       
                                          
            Sensitivity : 0.9225          
            Specificity : 0.6327          
         Pos Pred Value : 0.8890          
         Neg Pred Value : 0.7192          
             Prevalence : 0.7612          
         Detection Rate : 0.7022          
   Detection Prevalence : 0.7899          
      Balanced Accuracy : 0.7776          
                                          
       'Positive' Class : 0               
                                          
> 
> # getting acuracy, ROC, AUC, RECALL, PRECISION AND F VALUES
> plotROC(testData$RainTomorrow, as.numeric(testData$pred_majority))
> AUC(testData$RainTomorrow, testData$pred_majority)
[1] 0.7775934
> recall(testData$RainTomorrow, testData$pred_majority)
[1] 0.9225149
> precision(testData$RainTomorrow, testData$pred_majority)
[1] 0.8889544
> F_meas(testData$RainTomorrow, testData$pred_majority)
[1] 0.9054238